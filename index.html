=== "drag" && e.touches.length === 1) {
        const x = e.touches[0].clientX;
        const y = e.touches[0].clientY;

        const dx = x - lastX;
        const dy = y - lastY;

        obj.object3D.position.x += dx * MOVE_FACTOR;
        obj.object3D.position.z += dy * MOVE_FACTOR;

        lastX = x; lastY = y;
      }

      if (mode === "pinch" && e.touches.length === 2) {
        const d = dist(e.touches[0], e.touches[1]);
        const scale = clamp(startScale * (d / startDist), 0.1, 2.5);
        obj.object3D.scale.set(scale, scale, scale);

        const a = angle(e.touches[0], e.touches[1]);
        const delta = a - startAngle;
        const rotY = (startRotY + delta) * Math.PI / 180;
        obj.object3D.rotation.y = rotY;
      }
    }, { passive: true });

    document.addEventListener("touchend", (e) => {
      if (e.touches.length === 0) mode = "none";
      if (e.touches.length === 1) {
        mode = "drag";
        lastX = e.touches[0].clientX;
        lastY = e.touches[0].clientY;
      }
    }, { passive: true });
  </script>
</body>
</html>
